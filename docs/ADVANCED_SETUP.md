# Advanced Setup and Features

This guide covers advanced configuration options and features of the Google Calendar Sync application.

## 1. Email Notifications

The application can send detailed email notifications summarizing the results of each sync operation. This is especially useful for automated runs.

### Configuration

To enable email notifications, set the following environment variables:

```env
# .env
SEND_EMAIL=true
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-gmail-app-password
FROM_EMAIL=your-email@gmail.com
TO_EMAIL=recipient-email@example.com
```

### Setting Up Gmail for SMTP

You cannot use your regular Google account password. You must generate an **App Password**.

1.  **Enable 2-Step Verification** for your Google account.
2.  Go to your Google Account settings.
3.  Navigate to **Security** > **App passwords**.
4.  Generate a new App Password for "Mail" on "Other (custom name)".
5.  Use this 16-character password for the `SMTP_PASSWORD` variable.

### Email Content

The HTML email includes:
- A summary of events created, updated, or deleted.
- A detailed, sheet-by-sheet breakdown of changes.
- Error reports and success rates.

---

## 2. Dual Parser System

The application features two different parsers for interpreting your Google Sheet data. You can choose the one that best fits your spreadsheet's format.

### Traditional Parser

- **Best for**: Structured, predictable data.
- **Requires** a specific column order: `Date`, `Opponent`, `Location`, `Time`, etc.
- **How it works**: It maps columns to event fields based on their position.
- **Activation**: This is the default parser.

### Gemini AI Parser

- **Best for**: Less structured or complex data formats.
- **Requires**: Column headers that are descriptive (e.g., "Start Time", "Event Description"). It does not rely on a fixed column order.
- **How it works**: It uses the Google Gemini AI to understand the semantics of your spreadsheet and extract event data intelligently.
- **Activation**: Set the environment variable `USE_GEMINI=true`.

You can switch between parsers in the web UI to see which one works better for your data before syncing.

---

## 3. Monitoring and Analytics

The application includes a script to track sync history and visualize changes over time.

### How It Works

The `monitor_changes.py` script:
- Reads sync reports generated by `automated_sync.py`.
- Stores historical sync data in a local SQLite database (`sync_history.db`).
- Generates charts (`.png` files) showing sync trends.
- Prints a summary report to the console.

### Usage

1.  **Run the Automated Sync**:
    The monitoring script relies on data produced by the automation script.
    ```bash
    python automated_sync.py
    ```

2.  **Run the Monitoring Script**:
    ```bash
    python monitor_changes.py
    ```

### Output

- **`sync_history.db`**: A SQLite database file. You can use a tool like DB Browser for SQLite to explore the data.
- **`charts/` directory**: Contains PNG images of the sync statistics.
- **Console Report**: A summary of sync activity over the last 7 days.

---

## 4. Cross-Account Synchronization

For instructions on how to sync calendars between different Google accounts (e.g., running the app as one user to modify another user's calendars), please refer to the [Authentication and Authorization Guide](./AUTHENTICATION.md). That guide details the two primary methods for achieving this:

- **Calendar Sharing**: The calendar owner shares their calendar with the user running the sync.
- **Service Account with Domain-Wide Delegation**: A more advanced method for Google Workspace users that does not require manual sharing.
